{"version":3,"file":"clicked.es.js","sources":["../clicked.js"],"sourcesContent":["/**\n * Watcher for click, double-click, or long-click event for both mouse and touch\n * @example\n * import { clicked } from 'clicked'\n *\n * function handleClick()\n * {\n *    console.log('I was clicked.')\n * }\n *\n * const div = document.getElementById('clickme')\n * const c = clicked(div, handleClick, { threshold: 15 })\n *\n * // change callback\n * c.callback = () => console.log('different clicker')\n *\n * // destroy\n * c.destroy()\n *\n * // using built-in querySelector\n * clicked('#clickme', handleClick2)\n *\n * // watching for all types of clicks\n * function handleAllClicks(e) {\n *     switch (e.type)\n *     {\n *         case 'clicked': ...\n *         case 'double-clicked': ...\n *         case 'long-clicked': ...\n *     }\n *\n *     // view UIEvent that caused callback\n *     console.log(e.event)\n * }\n * clicked('#clickme', handleAllClicks, { doubleClicked: true, longClicked: true })\n */\n\n/** @type {object} */\nconst defaultOptions = {\n    threshold: 10,\n    clicked: true,\n    doubleClicked: false,\n    doubleClickedTime: 300,\n    longClicked: false,\n    longClickedTime: 500,\n    capture: false,\n    clickDown: false\n}\n\n/**\n * @param {HTMLElement|string} element or querySelector entry (e.g., #id-name or .class-name)\n * @param {ClickedCallback} callback called after a click, double click, or long click is registered\n * @param {object} [options]\n * @param {number} [options.threshold=10] if touch moves threshhold-pixels then the touch-click is cancelled\n * @param {boolean} [options.clicked=true] disable watcher for default clicked event\n * @param {boolean} [options.doubleClicked] enable watcher for double click\n * @param {number} [options.doubleClickedTime=500] wait time in millseconds for double click\n * @param {boolean} [options.longClicked] enable watcher for long click\n * @param {number} [options.longClickedTime=500] wait time for long click\n * @param {boolean} [options.clickDown] enable watcher for click start\n * @param {boolean} [options.capture]  events will be dispatched to this registered listener before being dispatched to any EventTarget beneath it in the DOM tree\n * @returns {Clicked}\n */\nexport function clicked(element, callback, options)\n{\n    return new Clicked(element, callback, options)\n}\n\nclass Clicked\n{\n    constructor(element, callback, options)\n    {\n        if (typeof element === 'string')\n        {\n            element = document.querySelector(element)\n            if (!element)\n            {\n                console.warn(`Unknown element: document.querySelector(${element}) in clicked()`)\n                return\n            }\n        }\n        this.options = Object.assign({}, defaultOptions, options)\n        this.events = {\n            mousedown: (e) => this.mousedown(e),\n            mouseup: (e) => this.mouseup(e),\n            mousemove: (e) => this.mousemove(e),\n            touchstart: (e) => this.touchstart(e),\n            touchmove: (e) => this.touchmove(e),\n            touchcancel: (e) => this.cancel(e),\n            touchend: (e) => this.touchend(e)\n        }\n        element.addEventListener('mousedown', this.events.mousedown, { capture: this.options.capture })\n        element.addEventListener('mouseup', this.events.mouseup, { capture: this.options.capture })\n        element.addEventListener('mousemove', this.events.mousemove, { capture: this.options.capture })\n        element.addEventListener('touchstart', this.events.touchstart, { passive: true, capture: this.options.capture })\n        element.addEventListener('touchmove', this.events.touchmove, { passive: true, capture: this.options.capture })\n        element.addEventListener('touchcancel', this.events.touchcancel, { capture: this.options.capture})\n        element.addEventListener('touchend', this.events.touchend, { capture: this.options.capture })\n        this.element = element\n        this.callback = callback\n    }\n\n    /**\n     * removes event listeners added by Clicked\n     */\n    destroy()\n    {\n        this.element.removeEventListener('mousedown', this.events.mousedown)\n        this.element.removeEventListener('mouseup', this.events.mouseup)\n        this.element.removeEventListener('mousemove', this.events.mousemove)\n        this.element.removeEventListener('touchstart', this.events.touchstart, { passive: true })\n        this.element.removeEventListener('touchmove', this.events.touchmove, { passive: true })\n        this.element.removeEventListener('touchcancel', this.events.touchcancel)\n        this.element.removeEventListener('touchend', this.events.touchend)\n    }\n\n    touchstart(e)\n    {\n        if (this.down === true)\n        {\n            this.cancel()\n        }\n        else\n        {\n            if (e.touches.length === 1)\n            {\n                this.handleDown(e.changedTouches[0].screenX, e.changedTouches[0].screenY)\n            }\n        }\n    }\n\n    pastThreshold(x, y)\n    {\n        return Math.abs(this.lastX - x) > this.options.threshold || Math.abs(this.lastY - y) > this.options.threshold\n    }\n\n    touchmove(e)\n    {\n        if (this.down)\n        {\n            if (e.touches.length !== 1)\n            {\n                this.cancel()\n            }\n            else\n            {\n                const x = e.changedTouches[0].screenX\n                const y = e.changedTouches[0].screenY\n                if (this.pastThreshold(x, y))\n                {\n                    this.cancel()\n                }\n            }\n        }\n    }\n\n    /** cancel current event */\n    cancel()\n    {\n        this.down = false\n        if (this.doubleClickedTimeout)\n        {\n            clearTimeout(this.doubleClickedTimeout)\n            this.doubleClickedTimeout = null\n        }\n        if (this.longClickedTimeout)\n        {\n            clearTimeout(this.longClickedTimeout)\n            this.longClickedTimeout = null\n        }\n    }\n\n    touchend(e)\n    {\n        if (this.down)\n        {\n            e.preventDefault()\n            this.handleClicks(e, e.pointerId)\n        }\n    }\n\n    handleClicks(e)\n    {\n        if (this.options.doubleClicked)\n        {\n            this.doubleClickedTimeout = setTimeout(() => this.doubleClickedCancel(e), this.options.doubleClickedTime)\n        }\n        else if (this.options.clicked)\n        {\n            this.callback({ event: e, type: 'clicked' })\n        }\n        if (this.longClickedTimeout)\n        {\n            clearTimeout(this.longClickedTimeout)\n            this.longClickedTimeout = null\n        }\n        this.down = false\n    }\n\n    handleDown(e, x, y)\n    {\n        if (this.doubleClickedTimeout)\n        {\n            if (this.pastThreshold(x, y))\n            {\n                if (this.options.clicked)\n                {\n                    this.callback({ event: e, type: 'clicked' })\n                }\n                this.cancel()\n            }\n            else\n            {\n                this.callback({ event: e, type: 'double-clicked' })\n                this.cancel()\n            }\n        }\n        else\n        {\n            this.lastX = x\n            this.lastY = y\n            this.down = true\n            if (this.options.longClicked)\n            {\n                this.longClickedTimeout = setTimeout(() => this.longClicked(e), this.options.longClickedTime)\n            }\n            if (this.options.clickDown) {\n                this.callback({ event: e, type: 'click-down' })\n            }\n        }\n    }\n\n    longClicked(e)\n    {\n        this.longClikedTimeout = null\n        this.down = false\n        this.callback({ event: e, type: 'long-clicked' })\n    }\n\n    doubleClickedCancel(e)\n    {\n        this.doubleClickedTimeout = null\n        if (this.options.clicked)\n        {\n            this.callback({ event: e, type: 'double-clicked' })\n        }\n    }\n\n    mousedown(e)\n    {\n        if (this.down === true)\n        {\n            this.down = false\n        }\n        else\n        {\n            this.handleDown(e, e.screenX, e.screenY)\n        }\n    }\n\n    mousemove(e)\n    {\n        if (this.down)\n        {\n            const x = e.screenX\n            const y = e.screenY\n            if (this.pastThreshold(x, y))\n            {\n                this.cancel()\n            }\n        }\n    }\n\n    mouseup(e)\n    {\n        if (this.down)\n        {\n            e.preventDefault()\n            this.handleClicks(e)\n        }\n    }\n}\n\n/**\n * Callback for\n * @callback Clicked~ClickedCallback\n * @param {UIEvent} event\n * @param {('clicked'|'double-clicked'|'long-clicked'|'click-down')} type\n */"],"names":[],"mappings":"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"}